<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>aws.sdk.s3 documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-aws-s3</span> <span class="project-version">0.5.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="aws.sdk.s3.html"><div class="inner"><span>aws.sdk.s3</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="aws.sdk.s3.html#var-bucket-exists.3F"><div class="inner"><span>bucket-exists?</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-copy-object"><div class="inner"><span>copy-object</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-create-bucket"><div class="inner"><span>create-bucket</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-delete-bucket"><div class="inner"><span>delete-bucket</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-delete-object"><div class="inner"><span>delete-object</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-delete-version"><div class="inner"><span>delete-version</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-generate-presigned-url"><div class="inner"><span>generate-presigned-url</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-get-bucket-acl"><div class="inner"><span>get-bucket-acl</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-get-object"><div class="inner"><span>get-object</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-get-object-acl"><div class="inner"><span>get-object-acl</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-get-object-metadata"><div class="inner"><span>get-object-metadata</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-grant"><div class="inner"><span>grant</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-list-buckets"><div class="inner"><span>list-buckets</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-list-objects"><div class="inner"><span>list-objects</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-list-versions"><div class="inner"><span>list-versions</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-object-exists.3F"><div class="inner"><span>object-exists?</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-object-seq"><div class="inner"><span>object-seq</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-put-multipart-object"><div class="inner"><span>put-multipart-object</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-put-object"><div class="inner"><span>put-object</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-revoke"><div class="inner"><span>revoke</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-s3-client"><div class="inner"><span>s3-client</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-update-bucket-acl"><div class="inner"><span>update-bucket-acl</span></div></a></li><li class="depth-1"><a href="aws.sdk.s3.html#var-update-object-acl"><div class="inner"><span>update-object-acl</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">aws.sdk.s3</h1><div class="doc"><pre class="plaintext">Functions to access the Amazon S3 storage service.

Each function takes a client object as its first argument. The
 client object is created by s3-client. s3-client takes a map containing
 :access-key and :secret-key, with optional :endpoint and :proxy urls.

The :proxy key must contain keys for :host and :port, and may contain keys
for :user, :password, :domain and :workstation.</pre></div><div class="public anchor" id="var-bucket-exists.3F"><h3>bucket-exists?</h3><div class="usage"><code>(bucket-exists? client name)</code></div><div class="doc"><pre class="plaintext">Returns true if the supplied bucket name already exists in S3.
</pre></div></div><div class="public anchor" id="var-copy-object"><h3>copy-object</h3><div class="usage"><code>(copy-object client bucket src-key dest-key)</code><code>(copy-object client src-bucket src-key dest-bucket dest-key)</code></div><div class="doc"><pre class="plaintext">Copy an existing S3 object to another key. Returns a map containing
the data returned from S3</pre></div></div><div class="public anchor" id="var-create-bucket"><h3>create-bucket</h3><div class="usage"><code>(create-bucket client name)</code></div><div class="doc"><pre class="plaintext">Create a new S3 bucket with the supplied name.
</pre></div></div><div class="public anchor" id="var-delete-bucket"><h3>delete-bucket</h3><div class="usage"><code>(delete-bucket client name)</code></div><div class="doc"><pre class="plaintext">Delete the S3 bucket with the supplied name.
</pre></div></div><div class="public anchor" id="var-delete-object"><h3>delete-object</h3><div class="usage"><code>(delete-object client bucket key)</code></div><div class="doc"><pre class="plaintext">Delete an object from an S3 bucket.
</pre></div></div><div class="public anchor" id="var-delete-version"><h3>delete-version</h3><div class="usage"><code>(delete-version client bucket key version-id)</code></div><div class="doc"><pre class="plaintext">Deletes a specific version of the specified object in the specified bucket.
</pre></div></div><div class="public anchor" id="var-generate-presigned-url"><h3>generate-presigned-url</h3><div class="usage"><code>(generate-presigned-url client bucket key &amp; [options])</code></div><div class="doc"><pre class="plaintext">Return a presigned URL for an S3 object. Accepts the following options:
:expires     - the date at which the URL will expire (defaults to 1 day from now)
:http-method - the HTTP method for the URL (defaults to :get)</pre></div></div><div class="public anchor" id="var-get-bucket-acl"><h3>get-bucket-acl</h3><div class="usage"><code>(get-bucket-acl client bucket)</code></div><div class="doc"><pre class="plaintext">Get the access control list (ACL) for the supplied bucket. The ACL is a map
containing two keys:
  :owner  - the owner of the ACL
  :grants - a set of access permissions granted

The grants themselves are maps with keys:
  :grantee    - the individual or group being granted access
  :permission - the type of permission (:read, :write, :read-acp, :write-acp or
                :full-control).</pre></div></div><div class="public anchor" id="var-get-object"><h3>get-object</h3><div class="usage"><code>(get-object client bucket key)</code><code>(get-object client bucket key version-id)</code></div><div class="doc"><pre class="plaintext">Get an object from an S3 bucket. The object is returned as a map with the
following keys:
  :content  - an InputStream to the content
  :metadata - a map of the object's metadata
  :bucket   - the name of the bucket
  :key      - the object's key
Be extremely careful when using this method; the :content value in the returned
map contains a direct stream of data from the HTTP connection. The underlying
HTTP connection cannot be closed until the user finishes reading the data and
closes the stream.
Therefore:
  * Use the data from the :content input stream as soon as possible
  * Close the :content input stream as soon as possible
If these rules are not followed, the client can run out of resources by
allocating too many open, but unused, HTTP connections.</pre></div></div><div class="public anchor" id="var-get-object-acl"><h3>get-object-acl</h3><div class="usage"><code>(get-object-acl client bucket key)</code></div><div class="doc"><pre class="plaintext">Get the access control list (ACL) for the supplied object. See get-bucket-acl
for a detailed description of the return value.</pre></div></div><div class="public anchor" id="var-get-object-metadata"><h3>get-object-metadata</h3><div class="usage"><code>(get-object-metadata client bucket key &amp; [options])</code></div><div class="doc"><pre class="plaintext">Get an object's metadata from a bucket.  A optional map of options may be supplied.
Available options are:
  :version-id - the version of the object
The metadata is a map with the
following keys:
  :cache-control          - the CacheControl HTTP header
  :content-disposition    - the ContentDisposition HTTP header
  :content-encoding       - the character encoding of the content
  :content-length         - the length of the content in bytes
  :content-md5            - the MD5 hash of the content
  :content-type           - the mime-type of the content
  :etag                   - the HTTP ETag header
  :last-modified          - the last modified date
  :server-side-encryption - the server-side encryption algorithm</pre></div></div><div class="public anchor" id="var-grant"><h3>grant</h3><div class="usage"><code>(grant grantee permission)</code></div><div class="doc"><pre class="plaintext">Returns a function that adds a new grant map to a set of grants.
See update-bucket-acl.</pre></div></div><div class="public anchor" id="var-list-buckets"><h3>list-buckets</h3><div class="usage"><code>(list-buckets client)</code></div><div class="doc"><pre class="plaintext">List all the S3 buckets for the supplied client. The buckets will be
returned as a seq of maps with the following keys:
  :name          - the bucket name
  :creation-date - the date when the bucket was created
  :owner         - the owner of the bucket</pre></div></div><div class="public anchor" id="var-list-objects"><h3>list-objects</h3><div class="usage"><code>(list-objects client bucket &amp; [options])</code></div><div class="doc"><pre class="plaintext">List the objects in an S3 bucket. A optional map of options may be supplied.
Available options are:
  :delimiter - read only keys up to the next delimiter (such as a '/')
  :marker    - read objects after this key
  :max-keys  - read only this many objects
  :prefix    - read only objects with this prefix

The object listing will be returned as a map containing the following keys:
  :bucket          - the name of the bucket
  :prefix          - the supplied prefix (or nil if none supplied)
  :objects         - a list of objects
  :common-prefixes - the common prefixes of keys omitted by the delimiter
  :max-keys        - the maximum number of objects to be returned
  :truncated?      - true if the list of objects was truncated
  :marker          - the marker of the listing
  :next-marker     - the next marker of the listing</pre></div></div><div class="public anchor" id="var-list-versions"><h3>list-versions</h3><div class="usage"><code>(list-versions client bucket &amp; [options])</code></div><div class="doc"><pre class="plaintext">List the versions in an S3 bucket. A optional map of options may be supplied.
Available options are:
  :delimiter         - the delimiter used in prefix (such as a '/')
  :key-marker        - read versions from the sorted list of all versions starting
                       at this marker.
  :max-results       - read only this many versions
  :prefix            - read only versions with keys having this prefix
  :version-id-marker - read objects after this version id

The version listing will be returned as a map containing the following versions:
  :bucket                 - the name of the bucket
  :prefix                 - the supplied prefix (or nil if none supplied)
  :versions               - a sorted list of versions, newest first, each
                            version has:
                            :version-id     - the unique version id
                            :latest?        - is this the latest version for that key?
                            :delete-marker? - is this a delete-marker?
  :common-prefixes        - the common prefixes of keys omitted by the delimiter
  :max-results            - the maximum number of results to be returned
  :truncated?             - true if the results were truncated
  :key-marker             - the key marker of the listing
  :next-version-id-marker - the version ID marker to use in the next listVersions
                            request in order to obtain the next page of results.
  :version-id-marker      - the version id marker of the listing</pre></div></div><div class="public anchor" id="var-object-exists.3F"><h3>object-exists?</h3><div class="usage"><code>(object-exists? client bucket key)</code></div><div class="doc"><pre class="plaintext">Returns true if an object exists in the supplied bucket and key.
</pre></div></div><div class="public anchor" id="var-object-seq"><h3>object-seq</h3><div class="usage"><code>(object-seq client bucket &amp; [prefix-or-options])</code></div><div class="doc"><pre class="plaintext">Return a lazy sequence of objects in an S3 bucket. See list-objects for options.
If prefix-or-options is a string, imply {:prefix prefix-or-options}</pre></div></div><div class="public anchor" id="var-put-multipart-object"><h3>put-multipart-object</h3><div class="usage"><code>(put-multipart-object client bucket key file &amp; [{:keys [part-size threads], :or {part-size (* 5 1024 1024), threads 16}}])</code></div><div class="doc"><pre class="plaintext">Do a multipart upload of a file into a S3 bucket at the specified key.
The value must be a java.io.File object.  The entire file is uploaded
or not at all.  If an exception happens at any time the upload is aborted
and the exception is rethrown. The size of the parts and the number of
threads uploading the parts can be configured in the last argument as a
map with the following keys:
  :part-size - the size in bytes of each part of the file.  Must be 5mb
               or larger.  Defaults to 5mb
  :threads   - the number of threads that will upload parts concurrently.
               Defaults to 16.</pre></div></div><div class="public anchor" id="var-put-object"><h3>put-object</h3><div class="usage"><code>(put-object client bucket key value &amp; [metadata &amp; permissions])</code></div><div class="doc"><pre class="plaintext">Put a value into an S3 bucket at the specified key. The value can be
a String, InputStream or File (or anything that implements the ToPutRequest
protocol).

An optional map of metadata may also be supplied that can include any of the
following keys:
  :cache-control          - the cache-control header (see RFC 2616)
  :content-disposition    - how the content should be downloaded by browsers
  :content-encoding       - the encoding of the content (e.g. gzip)
  :content-length         - the length of the content in bytes
  :content-md5            - the MD5 sum of the content
  :content-type           - the mime type of the content
  :server-side-encryption - set to AES256 if SSE is required

An optional list of grant functions can be provided after metadata.
These functions will be applied to a clear ACL and the result will be
the ACL for the newly created object.</pre></div></div><div class="public anchor" id="var-revoke"><h3>revoke</h3><div class="usage"><code>(revoke grantee permission)</code></div><div class="doc"><pre class="plaintext">Returns a function that removes a grant map from a set of grants.
See update-bucket-acl.</pre></div></div><div class="public anchor" id="var-s3-client"><h3>s3-client</h3><div class="usage"><code>(s3-client)</code><code>(s3-client cred)</code></div><div class="doc"><pre class="plaintext">Initializes an s3-client. If no credentials are provided, DefaultAWSCredentialsProviderChain is
used to search the default environment variables, properties, credentials files, and instance
profile credentials.</pre></div></div><div class="public anchor" id="var-update-bucket-acl"><h3>update-bucket-acl</h3><div class="usage"><code>(update-bucket-acl client bucket &amp; funcs)</code></div><div class="doc"><pre class="plaintext">Update the access control list (ACL) for the named bucket using functions
that update a set of grants (see get-bucket-acl).

This function is often used with the grant and revoke functions, e.g.

  (update-bucket-acl client bucket
    (grant :all-users :read)
    (grant {:email "foo@example.com"} :full-control)
    (revoke {:email "bar@example.com"} :write))</pre></div></div><div class="public anchor" id="var-update-object-acl"><h3>update-object-acl</h3><div class="usage"><code>(update-object-acl client bucket key &amp; funcs)</code></div><div class="doc"><pre class="plaintext">Updates the access control list (ACL) for the supplied object using functions
that update a set of grants (see update-bucket-acl for more details).</pre></div></div></div></body></html>